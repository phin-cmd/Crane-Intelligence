<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crane Valuation Report - {report_metadata[report_id]}</title>
    <style>
        * {{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }}
        
        body {{
            font-family: 'Arial', sans-serif;
            background: #ffffff;
            color: #000000;
            line-height: 1.4;
        }}
        
        .report-container {{
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }}
        
        .report-header {{
            background: #1a1a1a;
            color: #ffffff;
            padding: 30px;
            margin-bottom: 30px;
            border-radius: 8px;
            text-align: center;
        }}
        
        .report-title {{
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #00ff85;
        }}
        
        .report-subtitle {{
            font-size: 18px;
            color: #cccccc;
            margin-bottom: 20px;
        }}
        
        .report-meta {{
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: #999999;
        }}
        
        .kpi-grid {{
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }}
        
        .kpi-tile {{
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }}
        
        .kpi-tile:hover {{
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-color: #00ff85;
        }}
        
        .kpi-tile::before {{
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #00ff85, #007bff);
        }}
        
        .kpi-title {{
            font-size: 12px;
            font-weight: bold;
            color: #666666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
        }}
        
        .kpi-value {{
            font-size: 28px;
            font-weight: bold;
            color: #1a1a1a;
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
        }}
        
        .kpi-change {{
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }}
        
        .kpi-change.positive {{
            color: #28a745;
        }}
        
        .kpi-change.negative {{
            color: #dc3545;
        }}
        
        .kpi-trend {{
            font-size: 16px;
            margin-left: 5px;
        }}
        
        .section {{
            margin-bottom: 40px;
        }}
        
        .section-title {{
            font-size: 24px;
            font-weight: bold;
            color: #1a1a1a;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #00ff85;
            position: relative;
        }}
        
        .section-title::after {{
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 50px;
            height: 3px;
            background: #007bff;
        }}
        
        .valuation-summary {{
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }}
        
        .summary-grid {{
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }}
        
        .summary-item {{
            display: flex;
            flex-direction: column;
        }}
        
        .summary-label {{
            font-size: 14px;
            color: #666666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }}
        
        .summary-value {{
            font-size: 20px;
            font-weight: bold;
            color: #1a1a1a;
        }}
        
        .table-container {{
            background: #ffffff;
            border: 1px solid #dee2e6;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }}
        
        .table {{
            width: 100%;
            border-collapse: collapse;
        }}
        
        .table th {{
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #ffffff;
            font-weight: bold;
            padding: 15px 12px;
            text-align: left;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }}
        
        .table td {{
            padding: 15px 12px;
            border-bottom: 1px solid #e9ecef;
            font-size: 14px;
        }}
        
        .table tbody tr:hover {{
            background: #f8f9fa;
        }}
        
        .table tbody tr:nth-child(even) {{
            background: #f8f9fa;
        }}
        
        .finance-scenarios {{
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }}
        
        .scenario-card {{
            background: #ffffff;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }}
        
        .scenario-card:hover {{
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border-color: #00ff85;
        }}
        
        .scenario-title {{
            font-size: 20px;
            font-weight: bold;
            color: #1a1a1a;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #00ff85;
        }}
        
        .metric-row {{
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding: 8px 0;
            border-bottom: 1px solid #f8f9fa;
        }}
        
        .metric-label {{
            font-weight: 500;
            color: #666666;
            font-size: 14px;
        }}
        
        .metric-value {{
            font-weight: bold;
            color: #1a1a1a;
            font-size: 16px;
            font-family: 'Courier New', monospace;
        }}
        
        .highlight-metric {{
            background: #e8f5e8;
            padding: 8px 12px;
            border-radius: 6px;
            border-left: 4px solid #00ff85;
        }}
        
        .market-analysis {{
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            padding: 30px;
        }}
        
        .analysis-grid {{
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }}
        
        .analysis-section {{
            background: #ffffff;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #dee2e6;
        }}
        
        .analysis-title {{
            font-size: 16px;
            font-weight: bold;
            color: #1a1a1a;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }}
        
        .risk-factors {{
            list-style: none;
        }}
        
        .risk-factor {{
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f8f9fa;
        }}
        
        .risk-level {{
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }}
        
        .risk-level.low {{
            background: #d4edda;
            color: #155724;
        }}
        
        .risk-level.moderate {{
            background: #fff3cd;
            color: #856404;
        }}
        
        .risk-level.high {{
            background: #f8d7da;
            color: #721c24;
        }}
        
        .footer {{
            margin-top: 50px;
            padding: 30px;
            background: #1a1a1a;
            color: #ffffff;
            border-radius: 12px;
            text-align: center;
        }}
        
        .footer-title {{
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #00ff85;
        }}
        
        .footer-meta {{
            font-size: 14px;
            color: #cccccc;
            margin-bottom: 20px;
        }}
        
        .disclaimer {{
            font-size: 12px;
            color: #999999;
            line-height: 1.6;
        }}
        
        @media print {{
            .report-container {{
                max-width: none;
                padding: 0;
            }}
            
            .kpi-tile:hover {{
                transform: none;
                box-shadow: none;
            }}
            
            .scenario-card:hover {{
                transform: none;
                box-shadow: none;
            }}
        }}
    </style>
</head>
<body>
    <div class="report-container">
        <!-- Report Header -->
        <div class="report-header">
            <div class="report-title">CRANE VALUATION REPORT</div>
            <div class="report-subtitle">Professional Equipment Valuation & Market Analysis</div>
            <div class="report-meta">
                <div>Report ID: {report_metadata[report_id]}</div>
                <div>Generated: {report_metadata[generated_at]}</div>
            </div>
        </div>

        <!-- KPI Metrics -->
        <div class="section">
            <div class="section-title">KEY PERFORMANCE INDICATORS</div>
            <div class="kpi-grid">
                {kpi_metrics_html}
            </div>
        </div>

        <!-- Valuation Summary -->
        <div class="section">
            <div class="section-title">VALUATION SUMMARY</div>
            <div class="valuation-summary">
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-label">Equipment</div>
                        <div class="summary-value">{valuation_summary[equipment]}</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Year</div>
                        <div class="summary-value">{valuation_summary[year]}</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Capacity</div>
                        <div class="summary-value">{valuation_summary[capacity_tons]} Tons</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Operating Hours</div>
                        <div class="summary-value">{valuation_summary[hours]:,}</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Region</div>
                        <div class="summary-value">{valuation_summary[region]}</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Valuation Date</div>
                        <div class="summary-value">{valuation_summary[valuation_date]}</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comparable Sales -->
        <div class="section">
            <div class="section-title">COMPARABLE SALES ANALYSIS</div>
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Equipment</th>
                            <th>Year</th>
                            <th>Capacity</th>
                            <th>Hours</th>
                            <th>Sale Price</th>
                            <th>Price/Ton</th>
                            <th>Location</th>
                            <th>Sale Date</th>
                            <th>Condition</th>
                            <th>Trend</th>
                        </tr>
                    </thead>
                    <tbody>
                        {comparable_sales_html}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Finance Scenarios -->
        <div class="section">
            <div class="section-title">FINANCE SCENARIOS</div>
            <div class="finance-scenarios">
                {finance_scenarios_html}
            </div>
        </div>

        <!-- Market Analysis -->
        <div class="section">
            <div class="section-title">MARKET ANALYSIS</div>
            <div class="market-analysis">
                <div class="analysis-grid">
                    <div class="analysis-section">
                        <div class="analysis-title">Market Trends</div>
                        <div class="metric-row">
                            <span class="metric-label">Demand Level</span>
                            <span class="metric-value">{market_analysis[market_trends][demand_level]}</span>
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">Supply Level</span>
                            <span class="metric-value">{market_analysis[market_trends][supply_level]}</span>
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">Price Trend</span>
                            <span class="metric-value">{market_analysis[market_trends][price_trend]}</span>
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">YoY Growth</span>
                            <span class="metric-value">{market_analysis[market_trends][yoy_growth]}</span>
                        </div>
                    </div>
                    <div class="analysis-section">
                        <div class="analysis-title">Regional Analysis</div>
                        <div class="metric-row">
                            <span class="metric-label">Primary Market</span>
                            <span class="metric-value">{market_analysis[regional_analysis][primary_market]}</span>
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">Market Size</span>
                            <span class="metric-value">{market_analysis[regional_analysis][market_size]}</span>
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">Growth Rate</span>
                            <span class="metric-value">{market_analysis[regional_analysis][growth_rate]}</span>
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">Competition Level</span>
                            <span class="metric-value">{market_analysis[regional_analysis][competition_level]}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Risk Assessment -->
        <div class="section">
            <div class="section-title">RISK ASSESSMENT</div>
            <div class="analysis-grid">
                <div class="analysis-section">
                    <div class="analysis-title">Overall Risk: {risk_assessment[overall_risk]}</div>
                    <ul class="risk-factors">
                        {risk_factors_html}
                    </ul>
                </div>
                <div class="analysis-section">
                    <div class="analysis-title">Recommendations</div>
                    <ul class="risk-factors">
                        {recommendations_html}
                    </ul>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-title">CRANE INTELLIGENCE PLATFORM</div>
            <div class="footer-meta">
                Professional Equipment Valuation & Market Analysis
            </div>
            <div class="disclaimer">
                This report is for informational purposes only and should not be considered as financial advice. 
                All valuations are estimates based on available market data and should be verified independently. 
                Past performance does not guarantee future results.
            </div>
        </div>
    </div>
</body>
</html>
